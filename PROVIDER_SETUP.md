# Настройка провайдеров AI

## Поддерживаемые типы провайдеров

### 1. OpenAI Compatible (Рекомендуется для z.ai, Groq, Together и др.)

Используйте этот тип для всех провайдеров с совместимым OpenAI API.

#### Настройка z.ai

1. Откройте **Настройки**
2. В разделе "Поставщики AI" нажмите **Добавить**
3. Выберите тип: **OpenAI Compatible**
4. Заполните поля:

| Поле | Значение |
|-------|----------|
| **Имя провайдера** | z.ai |
| **Base URL** | `https://api.z.ai/api/anthropic` |
| **API Key** | Ваш API ключ (начинается с `sk-`) |
| **Model** | `gpt-4o-mini`, `glm-4-32b-0414-128k` или другая доступная модель |
| **Temperature** | `0.3` (по умолчанию) |
| **Max Tokens** | `4096` (по умолчанию) |

> **Важно:** z.ai использует кастомный API endpoint `/api/anthropic`, а не стандартный `/v1` или `/api/paas/v4`

5. Нажмите **Проверить соединение**
6. Если проверка прошла успешно, нажмите **Сохранить всё**

#### Другие OpenAI Compatible провайдеры

**Groq:**
- Base URL: `https://api.groq.com/openai/v1`
- Model: `llama3-8b-8192` или `mixtral-8x7b-32768`

**Together AI:**
- Base URL: `https://api.together.xyz/v1`
- Model: `mistralai/Mixtral-8x7B-Instruct-v0.1`

**OpenRouter:**
- Base URL: `https://openrouter.ai/api/v1`
- Model: `openai/gpt-4o-mini` или другая модель

### 2. OpenAI (Официальный)

Используйте для официального API OpenAI.

| Поле | Значение |
|-------|----------|
| **Base URL** | `https://api.openai.com/v1` |
| **API Key** | Ваш API ключ с platform.openai.com |
| **Model** | `gpt-4o`, `gpt-4o-mini`, `gpt-3.5-turbo` |

### 3. Anthropic Claude

| Поле | Значение |
|-------|----------|
| **Base URL** | `https://api.anthropic.com/v1` |
| **API Key** | Ваш API ключ с console.anthropic.com |
| **Model** | `claude-3-haiku-20240307`, `claude-3-opus-20240229` |

### 4. Google Gemini

| Поле | Значение |
|-------|----------|
| **Base URL** | `https://generativelanguage.googleapis.com/v1` |
| **API Key** | Ваш API ключ с makersuite.google.com |
| **Model** | `gemini-pro`, `gemini-1.5-pro` |

### 5. Ollama (Локальный)

Для запуска локальных моделей через Ollama.

1. Скачайте и установите Ollama: https://ollama.com
2. Запустите Ollama
3. В QuickTranslate:

| Поле | Значение |
|-------|----------|
| **Base URL** | `http://localhost:11434/v1` |
| **API Key** | (оставьте пустым) |
| **Model** | `llama3`, `mistral`, или другая установленная модель |

## Устранение проблем

### Проблема: API returned status Unauthorized

**Причина:** Неверный API ключ или истек срок действия.

**Решение:**
1. Проверьте API ключ на сайте провайдера
2. Убедитесь, что ключ скопирован полностью (без лишних пробелов)
3. Проверьте, что ключ не истек и имеет необходимые права

### Проблема: Empty response from API

**Возможные причины:**
1. Неверный Base URL
2. Неверное название модели
3. Проблемы с сетью
4. Несовместимый тип провайдера

**Решение:**
1. Проверьте правильность Base URL (документация провайдера)
2. Убедитесь, что модель доступна на данном провайдере
3. Попробуйте другое название модели
4. Проверьте подключение к интернету
5. Используйте тип провайдера "OpenAI Compatible" вместо других типов

### Проблема: Проверка соединения не проходит

**Шаги диагностики:**

1. **Проверьте URL в логах**
   - Откройте `%LOCALAPPDATA%\QuickTranslate\logs\`
   - Найдите строку: `Sending health check to <URL>`
   - Убедитесь, что URL правильный

2. **Проверьте API ключ**
   - Попробуйте сделать запрос через curl:
     ```bash
     curl https://api.z.ai/api/paas/v4/chat/completions \
       -H "Authorization: Bearer YOUR_API_KEY" \
       -H "Content-Type: application/json" \
       -d '{
         "model": "gpt-4o-mini",
         "messages": [{"role": "user", "content": "Hello"}],
         "max_tokens": 10
       }'
     ```

3. **Проверьте тип провайдера**
   - Для z.ai, Groq и др. используйте "OpenAI Compatible"
   - Не используйте "Anthropic" или "Google" для этих провайдеров

### Проблема: Настройки автоматически меняются

**Причина:** Вы переключаете тип провайдера в UI.

**Примечание:** Для типа "OpenAI Compatible" настройки больше не будут автоматически меняться при переключении типов. Вы можете настроить любой Base URL и модель.

## Рекомендации по использованию

### Выбор модели

**Для перевода:**
- Рекомендуется: `gpt-4o-mini` (быстро и качественно)
- Альтернативы: `llama3-8b`, `mistral-7b`

**Для кода:**
- Рекомендуется: `gpt-4o-mini` или `claude-3-haiku`
- Альтернативы: `deepseek-coder`, `code-llama`

### Настройка Temperature

- **0.1-0.3**: Более точный перевод, меньше вариативности
- **0.5-0.7**: Более естественный текст, больше вариативности
- **0.8-1.0**: Творческий перевод, может быть менее точным

### Настройка Max Tokens

Ограничивает длину перевода в токенах (примерно 1 токен ≈ 4 символа английского текста):

- **2048**: Короткие тексты (~8000 символов)
- **4096**: Средние тексты (~16000 символов)
- **8192**: Длинные тексты (~32000 символов)

## Советы по безопасности

1. **Не делитесь API ключами**
   - API ключи предоставляют доступ к вашему аккаунту и балансу

2. **Используйте ограничения**
   - Настройте лимиты на расход токенов на сайте провайдера

3. **Мониторьте использование**
   - Проверяйте статистику использования регулярно

4. **Обновляйте ключи**
   - Регулярно меняйте API ключи для безопасности

## Где получить API ключи

### z.ai
- Веб-сайт: https://z.ai
- Документация: https://open.z.ai/developer

### OpenAI
- Веб-сайт: https://platform.openai.com
- Получить ключ: https://platform.openai.com/api-keys

### Anthropic
- Веб-сайт: https://console.anthropic.com
- Получить ключ: https://console.anthropic.com/settings/keys

### Groq
- Веб-сайт: https://console.groq.com
- Получить ключ: https://console.groq.com/keys

### Together AI
- Веб-сайт: https://api.together.xyz
- Получить ключ: https://api.together.xyz/settings/api-keys

### Ollama
- Веб-сайт: https://ollama.com
- API ключ не требуется (локальный запуск)

## Дополнительная информация

### Перевод профилей

Приложение поддерживает профили перевода:

- **General**: Общий перевод (новости, статьи)
- **Technical**: Технический перевод (код, документация)
- **Creative**: Творческий перевод (литература, маркетинг)
- **Legal**: Юридический перевод (договоры, документы)

Профиль можно выбрать в настройках или включить автоопределение.

### История переводов

Все переводы сохраняются автоматически и доступны через кнопку "История".

История хранится в:
```
%LOCALAPPDATA%\QuickTranslate\history.json
```

### Горячие клавиши

- **Ctrl+Shift+T**: Перевести выделенный текст
- **Ctrl+Shift+O**: Показать/скрыть окно приложения

Горячие клавиши можно изменить в настройках.
